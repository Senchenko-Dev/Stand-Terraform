- name: Documentation block for revert with exception etcd host
  block:

    - name: remove existing documentation, readme.txt and releasenotes.json
      file:
        path: "{{ item }}"
        state: "absent"
      with_items:
        - "{{ PGHOME_OLD }}/readme.txt"
        - "{{ PGHOME_OLD }}/releasenotes.json"
        - "{{ PGHOME_OLD }}/{{ 'documentation' if ( [ pg_current_version, '5.2.0' ] | compare_pg_se_versions | int != 0 ) else 'doc' }}"

    - name: revert old documents directory
      copy:
        src: "{{ backup.doc }}/{{ 'documentation' if ( [ pg_current_version, '5.2.0' ] | compare_pg_se_versions | int != 0 ) else 'doc' }}"
        dest: "{{ PGHOME_OLD }}"
        owner: postgres
        group: postgres
        mode: 0750
        remote_src: yes

    - name: revert old readme.txt and releasenotes.json
      copy:
        src: "{{ backup.doc }}/{{ item }}"
        dest: "{{ PGHOME_OLD }}/{{ item }}"
        owner: postgres
        group: postgres
        remote_src: yes
      with_items:
        - "readme.txt"
        - "releasenotes.json"
          
  become: true
  when: inventory_hostname != 'etcd'